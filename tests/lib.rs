extern crate assert;
extern crate dwt;

#[test]
fn forward_haar() {
    let mut data = [
        4.217612826262750e-01, 9.157355251890671e-01, 7.922073295595544e-01, 9.594924263929030e-01,
        6.557406991565868e-01, 3.571167857418955e-02, 8.491293058687771e-01, 9.339932477575505e-01,
        6.787351548577735e-01, 7.577401305783334e-01, 7.431324681249162e-01, 3.922270195341682e-01,
        6.554778901775566e-01, 1.711866878115618e-01, 7.060460880196088e-01, 3.183284637742068e-02,
        2.769229849608900e-01, 4.617139063115394e-02, 9.713178123584754e-02, 8.234578283272926e-01,
        6.948286229758170e-01, 3.170994800608605e-01, 9.502220488383549e-01, 3.444608050290876e-02,
        4.387443596563982e-01, 3.815584570930084e-01, 7.655167881490024e-01, 7.951999011370632e-01,
        1.868726045543786e-01, 4.897643957882311e-01, 4.455862007108995e-01, 6.463130101112646e-01,
        7.093648308580726e-01, 7.546866819823609e-01, 2.760250769985784e-01, 6.797026768536748e-01,
        6.550980039738407e-01, 1.626117351946306e-01, 1.189976815583766e-01, 4.983640519821430e-01,
        9.597439585160811e-01, 3.403857266661332e-01, 5.852677509797773e-01, 2.238119394911370e-01,
        7.512670593056529e-01, 2.550951154592691e-01, 5.059570516651424e-01, 6.990767226566860e-01,
        8.909032525357985e-01, 9.592914252054443e-01, 5.472155299638031e-01, 1.386244428286791e-01,
        1.492940055590575e-01, 2.575082541237365e-01, 8.407172559836625e-01, 2.542821789715310e-01,
        8.142848260688164e-01, 2.435249687249893e-01, 9.292636231872278e-01, 3.499837659848087e-01,
        1.965952504312082e-01, 2.510838579760311e-01, 6.160446761466392e-01, 4.732888489027293e-01,
    ];

    let expected_data = [
         4.147168492759418e+00,  1.253279360754873e-01,
         4.084096467714702e-01,  4.658948064130208e-02,
         3.568483024108910e-01, -2.273188749167802e-01,
        -1.164386463345503e-01,  4.094163193731559e-02,
         2.173015620707741e-01,  3.561312405386555e-01,
        -2.661946778248070e-01,  2.165455455832754e-01,
         3.481467793065587e-01, -3.612840951056551e-02,
         3.656565682202418e-01,  2.828584634582116e-01,
        -2.071014740685578e-01, -5.458350879477758e-01,
         1.505578988885113e-01,  4.439282179604442e-02,
        -2.987476169855482e-01,  1.362998684770705e-02,
        -3.702069362683296e-01, -2.076311052397773e-01,
         2.541618794940903e-01,  1.001740028139758e-01,
         2.455249973556499e-01, -9.933579977845319e-02,
         5.821773524743806e-01, -3.440985876361998e-01,
        -1.107187971891155e-01, -3.208272083210646e-01,
        -3.492925366476388e-01, -1.182884263623091e-01,
         4.384267249862666e-01, -6.000786878777276e-02,
        -5.586495407948650e-02,  2.481276222538253e-01,
         3.424455932619815e-01,  4.767407551309557e-01,
         1.631660171201637e-01, -5.135900732507805e-01,
         2.670948384069484e-01,  6.475513972576711e-01,
         4.043653949084614e-02, -2.098913048058437e-02,
        -2.141768395471971e-01, -1.419352880929379e-01,
        -3.204738826591147e-02, -2.854431682706484e-01,
         3.482403802950402e-01, -2.682525330807729e-01,
         4.379524057248081e-01,  2.555878554029040e-01,
         3.508465461282888e-01, -1.365562289386354e-01,
        -4.835774064766307e-02,  2.889175284456297e-01,
        -7.651902898109114e-02,  4.146722196809334e-01,
         4.035881655568866e-01,  4.096127152326055e-01,
        -3.852926389235672e-02,  1.009436134980640e-01,
    ];

    dwt::forward(&mut data);

    assert::close(&data[..], &expected_data[..], 1e-15);
}
